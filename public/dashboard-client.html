<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Client - Marketplace 3D</title>
  <link rel="stylesheet" href="/css/styles.css">
  <link rel="stylesheet" href="/css/style.css">
  <style>
    /* Styles sp√©cifiques au dashboard */
    .dashboard {
      display: flex;
      min-height: calc(100vh - 60px);
    }

    .sidebar {
      width: 250px;
      background: white;
      border-right: 1px solid #eee;
      padding: 20px;
    }

    .sidebar-nav {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    .sidebar-nav li {
      margin-bottom: 8px;
    }

    .sidebar-nav a {
      display: block;
      padding: 12px 16px;
      color: #2d3436;
      text-decoration: none;
      border-radius: 8px;
      transition: all 0.2s;
      font-weight: 500;
    }

    .sidebar-nav a:hover {
      background: #f8f9fa;
      color: #0984e3;
    }

    .sidebar-nav a.active {
      background: #e3f2fd;
      color: #0984e3;
    }

    .dashboard-content {
      flex: 1;
      padding: 30px;
      background: #f8f9fa;
      overflow-y: auto;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .stat-card {
      background: white;
      padding: 24px;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      transition: transform 0.2s, box-shadow 0.2s;
    }

    .stat-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 4px 16px rgba(0,0,0,0.12);
    }

    .stat-icon {
      font-size: 32px;
      margin-bottom: 12px;
    }

    .stat-value {
      font-size: 32px;
      font-weight: 700;
      color: #0984e3;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 14px;
      color: #636e72;
      font-weight: 500;
    }

    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      margin-bottom: 20px;
    }

    .card-header {
      padding: 20px 24px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .card-title {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
      color: #2d3436;
    }

    .card-body {
      padding: 24px;
    }

    #projects-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
    }

    .project-card-image {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 8px 8px 0 0;
    }

    .project-info-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
      margin: 16px 0;
    }

    .info-item {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }

    .info-label {
      font-size: 12px;
      color: #636e72;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .info-value {
      font-size: 14px;
      color: #2d3436;
      font-weight: 600;
    }

    .card-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      flex-wrap: wrap;
    }

    .printer-info {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .printer-avatar-small {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
    }

    .printer-name {
      font-weight: 600;
      color: #2d3436;
    }

    .printer-rating {
      font-size: 12px;
      color: #636e72;
    }

    .quote-price {
      font-size: 18px;
      font-weight: 700;
      color: #00b894;
    }

    .quote-actions {
      display: flex;
      gap: 6px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      text-decoration: none;
      display: inline-block;
    }

    .btn-primary {
      background: #0984e3;
      color: white;
    }

    .btn-primary:hover {
      background: #0652a1;
    }

    .btn-secondary {
      background: #636e72;
      color: white;
    }

    .btn-secondary:hover {
      background: #2d3436;
    }

    .btn-success {
      background: #00b894;
      color: white;
    }

    .btn-success:hover {
      background: #00966d;
    }

    .btn-danger {
      background: #d63031;
      color: white;
    }

    .btn-danger:hover {
      background: #b71c1c;
    }

    .btn-info {
      background: #0984e3;
      color: white;
    }

    .btn-info:hover {
      background: #0652a1;
    }

    .btn-sm {
      padding: 6px 12px;
      font-size: 13px;
    }

    .badge {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 600;
    }

    .badge-secondary { background: #dfe6e9; color: #636e72; }
    .badge-info { background: #74b9ff; color: #0984e3; }
    .badge-warning { background: #ffeaa7; color: #fdcb6e; }
    .badge-success { background: #55efc4; color: #00b894; }
    .badge-danger { background: #fab1a0; color: #d63031; }
    .badge-primary { background: #a29bfe; color: #6c5ce7; }

    .hidden {
      display: none !important;
    }

    .text-danger {
      color: #d63031;
    }

    .text-secondary {
      color: #636e72;
    }

    .text-center {
      text-align: center;
    }

    @media (max-width: 768px) {
      .dashboard {
        flex-direction: column;
      }

      .sidebar {
        width: 100%;
        border-right: none;
        border-bottom: 1px solid #eee;
      }

      .stats-grid {
        grid-template-columns: 1fr 1fr;
      }

      #projects-grid {
        grid-template-columns: 1fr;
      }
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 20px;
    }

    .modal-content {
      background: white;
      border-radius: 12px;
      max-width: 600px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    }

    .modal-header {
      padding: 24px;
      border-bottom: 1px solid #eee;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-header h2 {
      margin: 0;
      font-size: 22px;
      color: #2d3436;
    }

    .modal-close {
      background: none;
      border: none;
      font-size: 24px;
      cursor: pointer;
      color: #636e72;
      padding: 0;
      width: 32px;
      height: 32px;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
      transition: background 0.2s;
    }

    .modal-close:hover {
      background: #f8f9fa;
    }

    .modal-body {
      padding: 24px;
    }

    .modal-subtitle {
      color: #636e72;
      margin-bottom: 12px;
    }

    .modal-footer {
      padding: 16px 24px;
      border-top: 1px solid #eee;
      display: flex;
      justify-content: flex-end;
      gap: 12px;
    }

    .search-bar {
      margin: 20px 0;
    }

    .search-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    .search-input:focus {
      outline: none;
      border-color: #0984e3;
    }

    .printers-list {
      max-height: 400px;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .printer-item {
      display: flex;
      align-items: center;
      padding: 12px;
      background: #f8f9fa;
      border-radius: 8px;
      gap: 12px;
    }

    .printer-checkbox {
      width: 20px;
      height: 20px;
      cursor: pointer;
    }

    .printer-label {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 12px;
      cursor: pointer;
    }

    .printer-avatar {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
    }

    .printer-info {
      flex: 1;
    }

    .printer-name {
      font-weight: 600;
      color: #2d3436;
      margin-bottom: 4px;
    }

    .printer-company {
      font-size: 12px;
      color: #636e72;
      margin-bottom: 4px;
    }

    .printer-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 12px;
      color: #636e72;
    }

    .badge-mini {
      padding: 2px 6px;
      background: #0984e3;
      color: white;
      border-radius: 4px;
      font-size: 10px;
      font-weight: 600;
    }

    .quote-summary {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .quote-summary h3 {
      margin: 0 0 16px 0;
      font-size: 16px;
      color: #2d3436;
    }

    .quote-details {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .quote-detail-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .quote-detail-item .label {
      color: #636e72;
      font-size: 14px;
    }

    .quote-detail-item .value {
      font-weight: 600;
      color: #2d3436;
      font-size: 14px;
    }

    .negotiation-info {
      background: #fff3cd;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .negotiation-info p {
      margin: 0;
      color: #856404;
      font-size: 14px;
    }

    .warning-box {
      background: #f8d7da;
      padding: 12px;
      border-radius: 8px;
      margin-bottom: 20px;
    }

    .warning-box p {
      margin: 0;
      color: #721c24;
      font-size: 14px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    .form-label {
      display: block;
      font-weight: 600;
      color: #2d3436;
      margin-bottom: 8px;
      font-size: 14px;
    }

    .form-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
    }

    .form-input:focus {
      outline: none;
      border-color: #0984e3;
    }

    .form-textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 14px;
      resize: vertical;
      font-family: inherit;
    }

    .form-textarea:focus {
      outline: none;
      border-color: #0984e3;
    }

    .form-help {
      display: block;
      font-size: 12px;
      color: #636e72;
      margin-top: 6px;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 8px;
      cursor: pointer;
      font-size: 14px;
      color: #2d3436;
    }

    .checkbox-label input[type="checkbox"] {
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    .text-center {
      text-align: center;
    }

    .text-secondary {
      color: #636e72;
    }
  </style>
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <!-- La navbar sera remplac√©e par createAuthNavbar() -->
      <a href="/" class="nav-logo">Marketplace 3D</a>
      <div class="nav-menu">
        <span>Chargement...</span>
      </div>
    </div>
  </nav>

  <div class="dashboard">
    <aside class="sidebar">
      <h3 class="mb-3">Menu Client</h3>
      <ul class="sidebar-nav">
        <li><a href="#" class="active">üìä Tableau de bord</a></li>
        <li><a href="#">üì¶ Mes projets</a></li>
        <li><a href="#">üí¨ Messages</a></li>
        <li><a href="#">üë§ Mon profil</a></li>
      </ul>
    </aside>

    <main class="dashboard-content">
      <h1 style="margin-bottom: 30px; color: #2d3436;">Dashboard Client</h1>

      <!-- Stats -->
      <div id="loading-stats" class="text-center" style="margin-bottom: 30px;">
        <p>Chargement des statistiques...</p>
      </div>
      <div id="stats-grid" class="stats-grid hidden">
        <div class="stat-card">
          <div class="stat-icon">üìä</div>
          <div id="stat-active-count" class="stat-value">0</div>
          <div class="stat-label">Projets en cours</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üí¨</div>
          <div id="stat-conversations-count" class="stat-value">0</div>
          <div class="stat-label">Conversations actives</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üìã</div>
          <div id="stat-pending-quotes-count" class="stat-value">0</div>
          <div class="stat-label">Devis en attente</div>
        </div>
        <div class="stat-card">
          <div class="stat-icon">üí∞</div>
          <div id="stat-budget-total" class="stat-value">0‚Ç¨</div>
          <div class="stat-label">Budget total investi</div>
        </div>
      </div>

      <!-- Actions rapides -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Actions rapides</h2>
        </div>
        <div class="card-body">
          <div style="display: flex; gap: 12px; flex-wrap: wrap;">
            <button class="btn btn-primary" id="newProjectBtn">
              ‚ûï Nouveau projet
            </button>
            <button class="btn btn-secondary" id="messagesBtn">
              üí¨ Messages
            </button>
          </div>
        </div>
      </div>

      <!-- Mes projets r√©cents -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Mes projets r√©cents</h2>
        </div>
        <div class="card-body">
          <div id="loading-projects" class="text-center">
            <p>Chargement des projets...</p>
          </div>
          <div id="projects-grid" class="grid grid-2 hidden">
            <!-- Projects will be loaded dynamically -->
          </div>
          <div id="no-projects" class="text-center text-secondary hidden">
            <p>Aucun projet pour le moment. Cr√©ez votre premier projet !</p>
            <button class="btn btn-primary mt-2" onclick="window.location.href='/create-project.html'">
              ‚ûï Nouveau projet
            </button>
          </div>
        </div>
      </div>

      <!-- Derniers devis re√ßus -->
      <div class="card">
        <div class="card-header">
          <h2 class="card-title">Derniers devis re√ßus</h2>
        </div>
        <div class="card-body">
          <div id="loading-quotes" class="text-center">
            <p>Chargement des devis...</p>
          </div>
          <div id="quotes-table" class="hidden" style="overflow-x: auto;">
            <table style="width: 100%; border-collapse: collapse;">
              <thead>
                <tr style="border-bottom: 2px solid #eee;">
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Imprimeur</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Projet</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Prix</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">D√©lai</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Mat√©riaux</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Statut</th>
                  <th style="padding: 12px; text-align: left; font-weight: 600; color: #636e72;">Actions</th>
                </tr>
              </thead>
              <tbody id="quotes-body">
                <!-- Quotes will be loaded dynamically -->
              </tbody>
            </table>
          </div>
          <div id="no-quotes" class="text-center text-secondary hidden">
            <p>Aucun devis re√ßu pour le moment.</p>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="/js/auth.js"></script>
  <script src="/js/dashboard-client.js"></script>
</body>
</html>
