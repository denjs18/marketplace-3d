<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soumettre un devis - Marketplace 3D</title>
  <link rel="stylesheet" href="/css/styles.css">
</head>
<body>
  <nav class="navbar">
    <div class="nav-container">
      <a href="/" class="logo">Strivex</a>
      <div class="flex gap-2">
        <a href="/dashboard-printer.html" class="btn btn-outline">Retour Dashboard</a>
      </div>
    </div>
  </nav>

  <div class="container" style="max-width: 800px; margin-top: 2rem;">
    <h1 class="mb-3">Soumettre un devis</h1>

    <!-- Loading state -->
    <div id="loading" style="text-align: center; padding: 40px;">
      <p>Chargement des informations du projet...</p>
    </div>

    <!-- Content -->
    <div id="content" class="hidden">
      <!-- Project info -->
      <div class="card mb-3">
        <div class="card-header">
          <h2 class="card-title">Informations du projet</h2>
        </div>
        <div class="card-body">
          <h3 id="project-title" class="mb-2">-</h3>
          <p id="project-description" class="text-secondary mb-3">-</p>
          <div class="grid grid-2">
            <div>
              <strong>Matériau demandé:</strong> <span id="project-material">-</span>
            </div>
            <div>
              <strong>Quantité:</strong> <span id="project-quantity">-</span>
            </div>
            <div>
              <strong>Budget client:</strong> <span id="project-budget">-</span>
            </div>
            <div>
              <strong>Délai souhaité:</strong> <span id="project-deadline">-</span>
            </div>
          </div>
        </div>
      </div>

    <!-- Quote form -->
    <form id="quote-form">
      <div class="card mb-3">
        <div class="card-header">
          <h2 class="card-title">Votre devis</h2>
        </div>
        <div class="card-body">
          <div class="form-group">
            <label class="form-label" for="price">Prix total (€) *</label>
            <input type="number" class="form-input" id="price" required min="1" step="0.01" placeholder="150.00">
            <small class="text-secondary">Le client paiera ce montant. Vous recevrez 90% après commission.</small>
            <div id="price-breakdown" class="mt-2 hidden">
              <div class="card" style="background: #f0f9ff; border: 2px solid var(--primary-color);">
                <div class="card-body">
                  <div class="flex-between mb-2">
                    <span>Prix client:</span>
                    <strong><span id="client-price">0</span> €</strong>
                  </div>
                  <div class="flex-between mb-2">
                    <span class="text-secondary">Commission plateforme (10%):</span>
                    <span class="text-secondary">- <span id="commission">0</span> €</span>
                  </div>
                  <hr>
                  <div class="flex-between">
                    <strong>Vous recevrez:</strong>
                    <strong class="text-success" style="font-size: 1.25rem;"><span id="your-payment">0</span> €</strong>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label" for="duration-value">Durée estimée *</label>
              <input type="number" class="form-input" id="duration-value" required min="1" placeholder="5">
            </div>

            <div class="form-group">
              <label class="form-label" for="duration-unit">Unité</label>
              <select class="form-select form-input" id="duration-unit">
                <option value="hours">Heures</option>
                <option value="days" selected>Jours</option>
                <option value="weeks">Semaines</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label class="form-label" for="delivery-date">Date de livraison estimée *</label>
            <input type="date" class="form-input" id="delivery-date" required>
          </div>

          <div class="form-group">
            <label class="form-label" for="message">Message au client *</label>
            <textarea class="form-textarea" id="message" required placeholder="Décrivez votre expertise, le process que vous utiliserez, la qualité attendue..."></textarea>
            <small class="text-secondary">Min 10 caractères, max 1000</small>
          </div>
        </div>
      </div>

      <!-- Optional: Cost breakdown -->
      <div class="card mb-3">
        <div class="card-header">
          <h2 class="card-title">Détails des coûts (optionnel)</h2>
        </div>
        <div class="card-body">
          <p class="text-secondary mb-3">Aidez le client à comprendre votre tarification</p>
          <div class="grid grid-2">
            <div class="form-group">
              <label class="form-label" for="cost-materials">Matériaux (€)</label>
              <input type="number" class="form-input" id="cost-materials" min="0" step="0.01" placeholder="40.00">
            </div>

            <div class="form-group">
              <label class="form-label" for="cost-labor">Main d'œuvre (€)</label>
              <input type="number" class="form-input" id="cost-labor" min="0" step="0.01" placeholder="80.00">
            </div>

            <div class="form-group">
              <label class="form-label" for="cost-shipping">Livraison (€)</label>
              <input type="number" class="form-input" id="cost-shipping" min="0" step="0.01" placeholder="15.00">
            </div>

            <div class="form-group">
              <label class="form-label" for="cost-other">Autres frais (€)</label>
              <input type="number" class="form-input" id="cost-other" min="0" step="0.01" placeholder="15.00">
            </div>
          </div>
        </div>
      </div>

      <!-- Submit -->
      <div class="flex gap-2">
        <button type="button" class="btn btn-outline" onclick="window.history.back()">Annuler</button>
        <button type="submit" class="btn btn-primary" style="flex: 1;">
          <span id="submit-text">Envoyer le devis</span>
          <span id="submit-loading" class="loading hidden"></span>
        </button>
      </div>
    </form>
    </div><!-- End content -->
  </div>

  <script src="/js/auth.js"></script>
  <script src="/js/submit-quote.js"></script>
</body>
</html>
